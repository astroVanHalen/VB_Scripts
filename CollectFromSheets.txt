' Macro Name: CollectSheetDataToSOXLeadSheet
' Author: astroVanHalen
' Created: 07/24/2025
' Modified: N/A
' Purpose: Loops through sheets (except SOX Lead Sheet) in the active workbook, copies data from columns A and B where A is non-empty, and populates a table on SOX Lead Sheet starting at row 6, columns B-D
' Usage: Run from any workbook with a SOX Lead Sheet; ensure the main sheet is named correctly
' Notes: Customizable for specific sheet names and table formats; assumes data starts in column A
'
Sub CollectSheetDataToSOXLeadSheet()
    Dim wsMain As Worksheet
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim nextRow As Long
    
    ' Set main sheet; update name if different
    On Error Resume Next
    Set wsMain = ActiveWorkbook.Sheets("SOX Lead Sheet")
    On Error GoTo 0
    If wsMain Is Nothing Then
        MsgBox "SOX Lead Sheet not found in the active workbook.", vbExclamation
        Exit Sub
    End If
    
    nextRow = 6 ' Start at row 6 in column B
    
    ' Loop through sheets, excluding the main sheet
    Application.ScreenUpdating = False
    For Each ws In ActiveWorkbook.Worksheets
        If ws.Index > wsMain.Index Then
            lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
            For i = 1 To lastRow
                If Trim(ws.Cells(i, 1).Value) <> "" Then
                    wsMain.Cells(nextRow, 2).Value = ws.Cells(i, 1).Value ' Column B: Number
                    wsMain.Cells(nextRow, 3).Value = ws.Cells(i, 2).Value ' Column C: Description
                    wsMain.Cells(nextRow, 4).Value = ws.Name             ' Column D: Sheet name
                    nextRow = nextRow + 1
                End If
            Next i
        End If
    Next ws
    Application.ScreenUpdating = True
    
    MsgBox "Data collection complete.", vbInformation
End Sub
