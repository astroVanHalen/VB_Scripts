' Macro Name: ResizeImageHeightOnly
' Author: astroVanHalen
' Created: 07/24/2025
' Modified: N/A
' Purpose: Resizes a selected image on the active sheet to a fixed height (5.7 inches>> can be modified) while maintaining aspect ratio
' Usage: Select an image in any workbook, then run via Ctrl + Y or Macros menu
' Notes: Used in workflows to paste, resize, cut, and paste images for consistent sizing; see ResizerUseCase.md for details
'
Sub ResizeImageHeightOnly()
    Dim shp As Shape
    On Error Resume Next
    Set shp = ActiveSheet.Shapes(Selection.Name)
    On Error GoTo 0
    
    If shp Is Nothing Then
        MsgBox "Please select an image before running.", vbExclamation
        Exit Sub
    End If
    
    ' Set target height in inches
    Const targetHeightInches As Double = 5.7
    Const pointsPerInch As Double = 72
    Dim targetHeightPoints As Double
    targetHeightPoints = targetHeightInches * pointsPerInch
    
    ' Lock aspect ratio and set height
    shp.LockAspectRatio = msoTrue
    shp.Height = targetHeightPoints
End Sub
